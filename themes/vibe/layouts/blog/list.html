{{ define "main" }}
<section class="section reveal" style="--reveal-duration: 820ms;">
  <div class="container">
    <h1 class="page-title">Blogs</h1>

    {{ $blog := .Site.GetPage "section" "blog" }}
    {{ $all := $blog.RegularPagesRecursive.ByDate.Reverse }}

    {{ $paginator := .Paginate $all 6 }}

    <div class="post-grid">
      {{ range $paginator.Pages }}
        <article class="post-card reveal" style="--reveal-delay: 160ms; --reveal-duration: 820ms;">
          <header class="post-card-header">
            <h3 class="post-card-title"><a class="link-subtle" href="{{ .RelPermalink }}">{{ .Title }}</a></h3>
          </header>
          <div class="post-card-body">
            {{ with .Params.description }}
              <p>{{ . }}</p>
            {{ else }}
              <p>{{ .Summary }}</p>
            {{ end }}
          </div>
          <footer class="post-card-footer">
            <span class="post-date muted">{{ .Date.Format "Jan 2, 2006" }}</span>
            <a class="btn btn-sm btn-outline read-btn" href="{{ .RelPermalink }}">Read</a>
          </footer>
        </article>
      {{ end }}
    </div>

    {{ if gt $paginator.TotalPages 1 }}
      {{ $total := $paginator.TotalPages }}
      {{ $cur := $paginator.PageNumber }}

      {{/* Mobile: icon-only First, Prev, Current, Next, Last */}}
      <nav class="pagination pagination--mobile" aria-label="Pagination (mobile)">
        {{ if gt $cur 1 }}
          {{ $first := index $paginator.Pagers 0 }}
          <a class="page-link" href="{{ $first.URL }}" aria-label="First page"><span class="material-symbols-rounded icon">first_page</span></a>
        {{ else }}
          <span class="page-link disabled" aria-disabled="true"><span class="material-symbols-rounded icon">first_page</span></span>
        {{ end }}
        {{ with $paginator.Prev }}
          <a class="page-link" href="{{ .URL }}" aria-label="Previous page"><span class="material-symbols-rounded icon">chevron_left</span></a>
        {{ else }}
          <span class="page-link disabled" aria-disabled="true"><span class="material-symbols-rounded icon">chevron_left</span></span>
        {{ end }}
        <span class="page-link current" aria-current="page">{{ $cur }}</span>
        {{ with $paginator.Next }}
          <a class="page-link" href="{{ .URL }}" aria-label="Next page"><span class="material-symbols-rounded icon">chevron_right</span></a>
        {{ else }}
          <span class="page-link disabled" aria-disabled="true"><span class="material-symbols-rounded icon">chevron_right</span></span>
        {{ end }}
        {{ if lt $cur $total }}
          {{ $last := index $paginator.Pagers (sub $total 1) }}
          <a class="page-link" href="{{ $last.URL }}" aria-label="Last page"><span class="material-symbols-rounded icon">last_page</span></a>
        {{ else }}
          <span class="page-link disabled" aria-disabled="true"><span class="material-symbols-rounded icon">last_page</span></span>
        {{ end }}
      </nav>

      {{/* Desktop: First, Prev, adjacent numbers with ellipses, Next, Last */}}
      <nav class="pagination pagination--desktop" aria-label="Pagination (desktop)">
        {{ if gt $cur 1 }}
          {{ $first := index $paginator.Pagers 0 }}
          <a class="page-link" href="{{ $first.URL }}" aria-label="First page"><span class="material-symbols-rounded icon">first_page</span></a>
        {{ else }}
          <span class="page-link disabled" aria-disabled="true"><span class="material-symbols-rounded icon">first_page</span></span>
        {{ end }}

        {{ with $paginator.Prev }}
          <a class="page-link" href="{{ .URL }}" aria-label="Previous page"><span class="material-symbols-rounded icon">chevron_left</span></a>
        {{ else }}
          <span class="page-link disabled" aria-disabled="true"><span class="material-symbols-rounded icon">chevron_left</span></span>
        {{ end }}

        {{ if gt $cur 3 }}
          <span class="page-ellipsis" aria-hidden="true">…</span>
        {{ end }}
        {{ if gt $cur 2 }}
          {{ $prevNum := sub $cur 1 }}
          {{ $prevPager := index $paginator.Pagers (sub $prevNum 1) }}
          <a class="page-link" href="{{ $prevPager.URL }}">{{ $prevNum }}</a>
        {{ end }}

        <span class="page-link current" aria-current="page">{{ $cur }}</span>

        {{ if lt $cur $total }}
          {{ $nextNum := add $cur 1 }}
          {{ $nextPager := index $paginator.Pagers (sub $nextNum 1) }}
          <a class="page-link" href="{{ $nextPager.URL }}">{{ $nextNum }}</a>
        {{ end }}
        {{ if lt $cur (sub $total 2) }}
          <span class="page-ellipsis" aria-hidden="true">…</span>
        {{ end }}

        {{ with $paginator.Next }}
          <a class="page-link" href="{{ .URL }}" aria-label="Next page"><span class="material-symbols-rounded icon">chevron_right</span></a>
        {{ else }}
          <span class="page-link disabled" aria-disabled="true"><span class="material-symbols-rounded icon">chevron_right</span></span>
        {{ end }}

        {{ if lt $cur $total }}
          {{ $last := index $paginator.Pagers (sub $total 1) }}
          <a class="page-link" href="{{ $last.URL }}" aria-label="Last page"><span class="material-symbols-rounded icon">last_page</span></a>
        {{ else }}
          <span class="page-link disabled" aria-disabled="true"><span class="material-symbols-rounded icon">last_page</span></span>
        {{ end }}
      </nav>
    {{ end }}
  </div>
</section>
{{ end }}
